<aside class="hidden sticky md:flex flex-col gap-6 w-72 min-w-[220px] max-w-xs bg-white rounded-xl shadow-lg p-5 h-fit top-6">
    <div>
        <h3 class="font-bold text-gray-800 mb-2 text-lg">Dica do Dia</h3>
        <div class="bg-blue-50 border-l-4 border-blue-400 p-3 rounded text-gray-700 text-sm">
            "Reserve um tempo para brincar com seu filho hoje. O vínculo criado nessas horas é fundamental!"<br>
            <span class="text-xs text-gray-400">— Psicóloga Dra. Ana</span>
        </div>
    </div>
    <div>
        <h3 class="font-bold text-gray-800 mb-2 text-lg">Missão da Semana</h3>
        <div class="bg-green-50 border-l-4 border-green-400 p-3 rounded text-gray-700 text-sm">
            <span class="font-semibold">Missão:</span> Fazer um piquenique em família.<br>
            <button id="postMissionBtn" class="mt-2 px-3 py-1 bg-green-400 text-white rounded hover:bg-green-500 transition">Postar missão</button>
        </div>
    </div>
    <div>
        <h3 class="font-bold text-gray-800 mb-2 text-lg">Recursos em Destaque</h3>
        <ul class="list-disc list-inside text-sm text-gray-700">
            <li><a href="#" class="text-blue-600 hover:underline">Livro: Crianças Felizes</a></li>
            <li><a href="#" class="text-blue-600 hover:underline">Vídeo: Como lidar com birras</a></li>
            <li><a href="#" class="text-blue-600 hover:underline">PDF: Guia de Rotina</a></li>
        </ul>
    </div>
</aside>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const postMissionBtn = document.getElementById('postMissionBtn');
    const loggedIn = document.querySelector('meta[name="validated"]')?.getAttribute('content');
    
    postMissionBtn.addEventListener('click', function(e) {
        e.preventDefault();
        
        if (!loggedIn) {
            // Se não está logado, mostra o popup de login
            showLoginPopup(
                function(event) {
                    // Após login bem-sucedido, redireciona para /escrever com categoria pré-selecionada
                    redirectToPostWithCategory('Desafio Semanal');
                },
                e,
                'Desafio Semanal'
            );
        } else {
            // Se já está logado, redireciona diretamente
            redirectToPostWithCategory('Desafio Semanal');
        }
    });
    
    function redirectToPostWithCategory(category) {
        // Armazena a categoria na sessionStorage para recuperar na página de escrita
        sessionStorage.setItem('selectedCategory', category);
        window.location.href = '/escrever';
    }
});
</script>